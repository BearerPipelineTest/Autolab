



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://docs.autolabproject.com/docker-compose/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-4.6.3">
    
    
      
        <title>Docker Compose Install - Autolab Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.adb8469c.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#ef5350">
      
    
    
      <script src="../assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
        
<script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-79424729-3", "auto")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="red" data-md-color-accent="blue">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#autolab-tango-docker-compose-installation" tabindex="0" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://docs.autolabproject.com/" title="Autolab Documentation" aria-label="Autolab Documentation" class="md-header-nav__button md-logo">
          
            <img alt="logo" src="../images/logo.svg" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Autolab Documentation
            </span>
            <span class="md-header-nav__topic">
              
                Docker Compose Install
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/Autolab/autolab/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Autolab
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://docs.autolabproject.com/" title="Autolab Documentation" class="md-nav__button md-logo">
      
        <img alt="logo" src="../images/logo.svg" width="48" height="48">
      
    </a>
    Autolab Documentation
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/Autolab/autolab/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Autolab
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      Autolab
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        Autolab
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href=".." title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../instructors/" title="Guide for Instructors" class="md-nav__link">
      Guide for Instructors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lab/" title="Guide for Lab Authors" class="md-nav__link">
      Guide for Lab Authors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../features/" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Autolab API
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Autolab API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../api-overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api-interface/" title="Reference" class="md-nav__link">
      Reference
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../command-line-interface/" title="Command Line Interface" class="md-nav__link">
      Command Line Interface
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../api-managing-authorized-apps/" title="Managing Authorized Apps" class="md-nav__link">
      Managing Authorized Apps
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Tango
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Tango
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../tango/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tango-cli/" title="Tango CLI" class="md-nav__link">
      Tango CLI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tango-rest/" title="REST API" class="md-nav__link">
      REST API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tango-vmms/" title="VMMS Docs" class="md-nav__link">
      VMMS Docs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tango-deploy/" title="Deploying Tango" class="md-nav__link">
      Deploying Tango
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Docker Compose Install
      </label>
    
    <a href="./" title="Docker Compose Install" class="md-nav__link md-nav__link--active">
      Docker Compose Install
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    Installation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-ssltls" class="md-nav__link">
    Configuring SSL/TLS
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#option-1-lets-encrypt" class="md-nav__link">
    Option 1: Let's Encrypt
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-2-using-your-own-tls-certificate" class="md-nav__link">
    Option 2: Using your own TLS certificate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-3-no-tls-not-recommended-only-for-local-developmenttesting" class="md-nav__link">
    Option 3: No TLS (not recommended, only for local development/testing)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updating-autolabtango-deployment" class="md-nav__link">
    Updating Autolab/Tango Deployment
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#debugging-your-deployment" class="md-nav__link">
    Debugging your Deployment
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#better-logging-output-for-docker-compose" class="md-nav__link">
    Better logging output for Docker Compose
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checking-autolab-logs" class="md-nav__link">
    Checking Autolab logs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accessing-the-rails-console" class="md-nav__link">
    Accessing the Rails console
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checking-tango-logs" class="md-nav__link">
    Checking Tango Logs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#troubleshooting-autolabtango-connection" class="md-nav__link">
    Troubleshooting Autolab/Tango Connection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#permission-issues-in-autolab" class="md-nav__link">
    Permission issues in Autolab
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../one-click/" title="(Legacy) OneClick Install" class="md-nav__link">
      (Legacy) OneClick Install
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    Installation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-ssltls" class="md-nav__link">
    Configuring SSL/TLS
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#option-1-lets-encrypt" class="md-nav__link">
    Option 1: Let's Encrypt
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-2-using-your-own-tls-certificate" class="md-nav__link">
    Option 2: Using your own TLS certificate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-3-no-tls-not-recommended-only-for-local-developmenttesting" class="md-nav__link">
    Option 3: No TLS (not recommended, only for local development/testing)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updating-autolabtango-deployment" class="md-nav__link">
    Updating Autolab/Tango Deployment
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#debugging-your-deployment" class="md-nav__link">
    Debugging your Deployment
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#better-logging-output-for-docker-compose" class="md-nav__link">
    Better logging output for Docker Compose
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checking-autolab-logs" class="md-nav__link">
    Checking Autolab logs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accessing-the-rails-console" class="md-nav__link">
    Accessing the Rails console
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checking-tango-logs" class="md-nav__link">
    Checking Tango Logs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#troubleshooting-autolabtango-connection" class="md-nav__link">
    Troubleshooting Autolab/Tango Connection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#permission-issues-in-autolab" class="md-nav__link">
    Permission issues in Autolab
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/Autolab/autolab/edit/master/docs/docker-compose.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="autolab-tango-docker-compose-installation">Autolab + Tango Docker Compose Installation</h1>
<p>The Autolab Docker Compose installation is a fast and easy production-ready installation and deployment method. It uses a MySQL database for the Autolab deployment, and comes with SSL support. This is now the preferred way of installing Autolab.</p>
<p>The Docker Compose installation method is relatively new and so you may likely run into issues. If you are stuck or find issues with the installation process please join our Slack <a href="https://autolab-slack.herokuapp.com/">here</a> and let us know and we will try our best to help. Also see the <a href="#debugging">debugging</a> section for tips on how to diagnose problems.</p>
<h2 id="installation">Installation</h2>
<p>First ensure that you have Docker and Docker Compose installed on your machine. See the official <a href="See https://docs.docker.com/install/">Docker docs</a> for the installation steps.</p>
<ol>
<li>Clone this repository and its submodules: <code>git clone --recurse-submodules -j8 git://github.com/autolab/docker.git autolab-docker</code></li>
<li>Enter the project directory: <code>cd autolab-docker</code></li>
<li>Update submodules: <code>make update</code></li>
<li>Create initial configs: <code>make</code></li>
<li>Build the Dockerfiles: <code>docker-compose build</code></li>
<li>Run the containers: <code>docker-compose up -d</code>. Note at this point Nginx will still be crash-looping in the Autolab container because SSL has not been configuired/disabled yet.</li>
<li>Ensure that the newly created config files have the right permissions: <code>make set-perms</code></li>
<li>Perform migrations: <code>make db-migrate</code></li>
<li>Create initial root user: <code>make create-user</code></li>
<li>Stop all containers: <code>docker-compose stop</code></li>
<li>Continue with TLS setup as outlined in the next section</li>
</ol>
<h2 id="configuring-ssltls">Configuring SSL/TLS</h2>
<p>There are three options for TLS: using Let's Encrypt (for free TLS certificates), using your own certificate, and not using TLS (not recommended for production deployment).</p>
<h3 id="option-1-lets-encrypt">Option 1: Let's Encrypt</h3>
<ol>
<li>Ensure that your DNS record points towards the IP address of your server</li>
<li>Ensure that port 443 is exposed on your server (i.e checking your firewall, AWS security group settings, etc)</li>
<li>Get initial SSL setup script: <code>make ssl</code></li>
<li>In <code>ssl/init-letsencrypt.sh</code>, change <code>domains=(example.com)</code> to the list of domains that your host is associated with, and change <code>email</code> to be your email address so that Let's Encrypt will be able to email you when your certificate is about to expire</li>
<li>If necessary, change <code>staging=0</code> to <code>staging=1</code> to avoid being rate-limited by Let's Encrypt since there is a limit of 20 certificates/week. Setting this is helpful if you have an experimental setup.</li>
<li>Run your modified script: <code>sudo sh ./ssl/init-letsencrypt.sh</code></li>
</ol>
<h3 id="option-2-using-your-own-tls-certificate">Option 2: Using your own TLS certificate</h3>
<ol>
<li>Copy your private key to ./ssl/privkey.pem</li>
<li>Copy your certificate to ./ssl/fullchain.pem</li>
<li>Generate your dhparams, i.e <code>openssl dhparam -out ./ssl/ssl-dhparams.pem 4096</code></li>
<li>Uncomment the following lines in <code>docker-compose.yml</code>:</li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="err">    # - ./ssl/fullchain.pem:/etc/letsencrypt/live/test.autolab.io/fullchain.pem;</span>
<span class="err">    # - ./ssl/privkey.pem:/etc/letsencrypt/live/test.autolab.io/privkey.pem;</span>
<span class="err">    # - ./ssl/ssl-dhparams.pem:/etc/letsencrypt/ssl-dhparams.pem</span>
</code></pre></div>


<h3 id="option-3-no-tls-not-recommended-only-for-local-developmenttesting">Option 3: No TLS (not recommended, only for local development/testing)</h3>
<ol>
<li>In <code>docker-compose.yml</code> (for all the subsequent steps), comment out the following:</li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="err">    # Comment the below out to disable SSL (not recommended)</span>
<span class="err">    - ./nginx/app.conf:/etc/nginx/sites-enabled/webapp.conf</span>
</code></pre></div>


<p>Also uncomment the following:</p>
<div class="codehilite"><pre><span></span><code><span class="err">   # Uncomment the below to disable SSL (not recommended)</span>
<span class="err">   # - ./nginx/no-ssl-app.conf:/etc/nginx/sites-enabled/webapp.conf</span>
</code></pre></div>


<p>Lastly set <code>DOCKER_SSL=false</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="err">    environment:</span>
<span class="err">      - DOCKER_SSL=true                         # set to false for no SSL (not recommended)</span>
</code></pre></div>


<h2 id="updating-autolabtango-deployment">Updating Autolab/Tango Deployment</h2>
<ol>
<li>Stop your running instances: <code>docker-compose stop</code></li>
<li>Run <code>make update</code> to update your Autolab and Tango repositories</li>
<li>Run <code>docker-compose build</code> to rebuild the images with the latest code</li>
<li>Re-deploy your containers with <code>docker-compose up</code></li>
</ol>
<h2 id="debugging-your-deployment">Debugging your Deployment</h2>
<p>In the (very likely) event that you run into problems during setup, hopefully these steps will help you to help identify and diagnose the issue. If you continue to face difficulties or believe you discovered issues with the setup process please join our Slack <a href="https://autolab-slack.herokuapp.com/">here</a> and let us know and we will try our best to help.</p>
<h3 id="better-logging-output-for-docker-compose">Better logging output for Docker Compose</h3>
<p>By default, <code>docker-compose up -d</code> runs in detached state and it is not easy to immediately see errors:</p>
<div class="codehilite"><pre><span></span><code>$ docker-compose up -d
Starting certbot ... <span class="k">done</span>
Starting redis   ... <span class="k">done</span>
Starting mysql   ... <span class="k">done</span>
Starting tango     ... <span class="k">done</span>
Recreating autolab ... <span class="k">done</span>
</code></pre></div>


<p>Use <code>docker-compose up</code> instead to get output from all the containers in real time:</p>
<div class="codehilite"><pre><span></span><code><span class="err">$</span><span class="w"> </span><span class="n">docker</span><span class="o">-</span><span class="n">compose</span><span class="w"> </span><span class="n">up</span><span class="w"></span>
<span class="n">Starting</span><span class="w"> </span><span class="n">certbot</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="n">done</span><span class="w"></span>
<span class="n">Starting</span><span class="w"> </span><span class="n">mysql</span><span class="w">   </span><span class="p">...</span><span class="w"> </span><span class="n">done</span><span class="w"></span>
<span class="n">Starting</span><span class="w"> </span><span class="n">redis</span><span class="w">   </span><span class="p">...</span><span class="w"> </span><span class="n">done</span><span class="w"></span>
<span class="n">Starting</span><span class="w"> </span><span class="n">tango</span><span class="w">   </span><span class="p">...</span><span class="w"> </span><span class="n">done</span><span class="w"></span>
<span class="n">Starting</span><span class="w"> </span><span class="n">autolab</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="n">done</span><span class="w"></span>
<span class="n">Attaching</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">redis</span><span class="p">,</span><span class="w"> </span><span class="n">mysql</span><span class="p">,</span><span class="w"> </span><span class="n">certbot</span><span class="p">,</span><span class="w"> </span><span class="n">tango</span><span class="p">,</span><span class="w"> </span><span class="n">autolab</span><span class="w"></span>
<span class="n">mysql</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="o">[</span><span class="n">Entrypoint</span><span class="o">]</span><span class="w"> </span><span class="n">MySQL</span><span class="w"> </span><span class="n">Docker</span><span class="w"> </span><span class="nc">Image</span><span class="w"> </span><span class="mf">8.0.22</span><span class="o">-</span><span class="mf">1.1.18</span><span class="w"></span>
<span class="n">tango</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="mi">2020</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">11</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">33</span><span class="err">:</span><span class="mi">19</span><span class="p">,</span><span class="mi">533</span><span class="w"> </span><span class="n">CRIT</span><span class="w"> </span><span class="n">Supervisor</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="p">(</span><span class="k">no</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="k">file</span><span class="p">)</span><span class="w"></span>
<span class="n">redis</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span><span class="n">C</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="n">Nov</span><span class="w"> </span><span class="mi">2020</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">33</span><span class="err">:</span><span class="mf">19.032</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">oO0OoO0OoO0Oo</span><span class="w"> </span><span class="n">Redis</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="n">oO0OoO0OoO0Oo</span><span class="w"></span>
<span class="n">redis</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span><span class="n">C</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="n">Nov</span><span class="w"> </span><span class="mi">2020</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">33</span><span class="err">:</span><span class="mf">19.032</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">Redis</span><span class="w"> </span><span class="n">version</span><span class="o">=</span><span class="mf">6.0.9</span><span class="p">,</span><span class="w"> </span><span class="n">bits</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span><span class="w"> </span><span class="k">commit</span><span class="o">=</span><span class="mi">00000000</span><span class="p">,</span><span class="w"> </span><span class="n">modified</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">pid</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="n">started</span><span class="w"></span>
<span class="n">redis</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span><span class="n">C</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="n">Nov</span><span class="w"> </span><span class="mi">2020</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">33</span><span class="err">:</span><span class="mf">19.032</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nl">Warning</span><span class="p">:</span><span class="w"> </span><span class="k">no</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="k">file</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">config</span><span class="p">.</span><span class="w"> </span><span class="ow">In</span><span class="w"> </span><span class="k">order</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">specify</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="k">file</span><span class="w"> </span><span class="k">use</span><span class="w"> </span><span class="n">redis</span><span class="o">-</span><span class="n">server</span><span class="w"> </span><span class="o">/</span><span class="k">path</span><span class="o">/</span><span class="k">to</span><span class="o">/</span><span class="n">redis</span><span class="p">.</span><span class="n">conf</span><span class="w"></span>
<span class="n">mysql</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="o">[</span><span class="n">Entrypoint</span><span class="o">]</span><span class="w"> </span><span class="n">Starting</span><span class="w"> </span><span class="n">MySQL</span><span class="w"> </span><span class="mf">8.0.22</span><span class="o">-</span><span class="mf">1.1.18</span><span class="w"></span>
<span class="n">redis</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span><span class="n">M</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="n">Nov</span><span class="w"> </span><span class="mi">2020</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">33</span><span class="err">:</span><span class="mf">19.033</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Running</span><span class="w"> </span><span class="n">mode</span><span class="o">=</span><span class="n">standalone</span><span class="p">,</span><span class="w"> </span><span class="n">port</span><span class="o">=</span><span class="mf">6379.</span><span class="w"></span>
<span class="n">redis</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span><span class="n">M</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="n">Nov</span><span class="w"> </span><span class="mi">2020</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">33</span><span class="err">:</span><span class="mf">19.033</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">Server</span><span class="w"> </span><span class="n">initialized</span><span class="w"></span>
<span class="n">tango</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="mi">2020</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">11</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">33</span><span class="err">:</span><span class="mi">19</span><span class="p">,</span><span class="mi">539</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="n">RPC</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="s1">&#39;supervisor&#39;</span><span class="w"> </span><span class="n">initialized</span><span class="w"></span>
<span class="n">tango</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="mi">2020</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">11</span><span class="w"> </span><span class="mi">04</span><span class="err">:</span><span class="mi">33</span><span class="err">:</span><span class="mi">19</span><span class="p">,</span><span class="mi">539</span><span class="w"> </span><span class="n">CRIT</span><span class="w"> </span><span class="n">Server</span><span class="w"> </span><span class="s1">&#39;unix_http_server&#39;</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="k">without</span><span class="w"> </span><span class="ow">any</span><span class="w"> </span><span class="n">HTTP</span><span class="w"> </span><span class="n">authentication</span><span class="w"> </span><span class="n">checking</span><span class="w"></span>
<span class="n">mysql</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="mi">2020</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">11</span><span class="nl">T04</span><span class="p">:</span><span class="mi">33</span><span class="err">:</span><span class="mf">19.476749</span><span class="n">Z</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">[</span><span class="n">System</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">MY-010116</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">Server</span><span class="o">]</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">mysqld</span><span class="w"> </span><span class="p">(</span><span class="n">mysqld</span><span class="w"> </span><span class="mf">8.0.22</span><span class="p">)</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="mi">22</span><span class="w"></span>
<span class="c1">--- output truncated ---</span>
</code></pre></div>


<h3 id="checking-autolab-logs">Checking Autolab logs</h3>
<p>If the Autolab instance is not working properly, taking a look at both the application logs as well as the Nginx logs in the container will be helpful.</p>
<p>First, find the name of the container. This should be just <code>autolab</code> by default:</p>
<div class="codehilite"><pre><span></span><code>$ docker ps
CONTAINER ID        IMAGE                       COMMAND                  CREATED             STATUS                    PORTS                                      NAMES
765d35962f52        autolab-docker_autolab      <span class="s2">&quot;/sbin/my_init&quot;</span>          <span class="m">31</span> minutes ago      Up <span class="m">22</span> minutes             <span class="m">0</span>.0.0.0:80-&gt;80/tcp, <span class="m">0</span>.0.0.0:443-&gt;443/tcp   autolab
a5b77b5267b1        autolab-docker_tango        <span class="s2">&quot;/usr/bin/supervisor…&quot;</span>   <span class="m">7</span> days ago          Up <span class="m">22</span> minutes             <span class="m">0</span>.0.0.0:3000-&gt;3000/tcp                     tango
438d8e9f73e2        redis:latest                <span class="s2">&quot;docker-entrypoint.s…&quot;</span>   <span class="m">7</span> days ago          Up <span class="m">22</span> minutes             <span class="m">6379</span>/tcp                                   redis
da86acc5a4c3        mysql/mysql-server:latest   <span class="s2">&quot;/entrypoint.sh mysq…&quot;</span>   <span class="m">7</span> days ago          Up <span class="m">22</span> minutes <span class="o">(</span>healthy<span class="o">)</span>   <span class="m">3306</span>/tcp, <span class="m">33060</span>-33061/tcp                  mysql
88032e85d669        a2eb12050715                <span class="s2">&quot;/bin/bash&quot;</span>              <span class="m">9</span> days ago          Up <span class="m">2</span> days                                                            compiler
</code></pre></div>


<p>Next get a shell inside the container:</p>
<div class="codehilite"><pre><span></span><code>$ docker <span class="nb">exec</span> -it autolab bash
root@be56be775428:/home/app/webapp# 
</code></pre></div>


<p>By default we are in the project directory. Navigate to the <code>logs</code> directory and <code>cat</code> or <code>tail</code> <code>production.log</code>. This contains logs from the Autolab application itself.</p>
<div class="codehilite"><pre><span></span><code><span class="err">root@be56be775428:/home/app/webapp# cd log</span>
<span class="err">root@be56be775428:/home/app/webapp/log# tail -f -n +1 production.log </span>
</code></pre></div>


<p>We can also check out our Nginx logs in <code>/var/log/nginx/</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="err">root@be56be775428:/home/app/webapp/log# cd /var/log/nginx/</span>
<span class="err">root@be56be775428:/var/log/nginx# ls</span>
<span class="err">access.log  error.log</span>
</code></pre></div>


<h3 id="accessing-the-rails-console">Accessing the Rails console</h3>
<p>Obtain a shell in the <code>autolab</code> container as described <a href="#checking-autolab-logs">previously</a>, and do <code>RAILS_ENV=production bundle exec rails c</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="err">root@be56be775428:/home/app/webapp# RAILS_ENV=production bundle exec rails c</span>
<span class="err">Loading production environment (Rails 5.2.0)</span>
<span class="err">2.6.6 :001 &gt; User.all.count</span>
<span class="err"> =&gt; 1</span>
</code></pre></div>


<p>In the example above, if you performed <code>make create-user</code> you should have at least one user in your database. If there are errors connecting to a database here it is likely that the database was misconfigured.</p>
<h3 id="checking-tango-logs">Checking Tango Logs</h3>
<p>Get a shell in the Tango instance, similar to the instructions mentioned <a href="#checking-autolab-logs">previously</a>. The logs are stored in the parent folder (<code>/opt/TangoService</code>) of the project directory:</p>
<div class="codehilite"><pre><span></span><code>$ docker <span class="nb">exec</span> -it tango bash
root@a5b77b5267b1:/opt/TangoService/Tango# <span class="nb">cd</span> ..
root@a5b77b5267b1:/opt/TangoService# ls
Tango  tango_job_manager_log.log  tango_log.log
root@a5b77b5267b1:/opt/TangoService# tail -f -n +1 tango_job_manager_log.log tango_log.log 
</code></pre></div>


<h3 id="troubleshooting-autolabtango-connection">Troubleshooting Autolab/Tango Connection</h3>
<p>In the Autolab container, try to curl Tango:</p>
<div class="codehilite"><pre><span></span><code><span class="err">root@be56be775428:/home/app/webapp# curl tango:3000</span>
<span class="err">Hello, world! RESTful Tango here!</span>
</code></pre></div>


<p>In the Tango container, try to curl Autolab:</p>
<div class="codehilite"><pre><span></span><code>root@a5b77b5267b1:/opt/TangoService/Tango# curl autolab
<span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;&lt;title&gt;</span>301 Moved Permanently<span class="nt">&lt;/title&gt;&lt;/head&gt;</span>
<span class="nt">&lt;body</span> <span class="na">bgcolor=</span><span class="s">&quot;white&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;center&gt;&lt;h1&gt;</span>301 Moved Permanently<span class="nt">&lt;/h1&gt;&lt;/center&gt;</span>
<span class="nt">&lt;hr&gt;&lt;center&gt;</span>nginx/1.14.0 (Ubuntu)<span class="nt">&lt;/center&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div>


<h3 id="permission-issues-in-autolab">Permission issues in Autolab</h3>
<p>Run <code>make set-perms</code> again</p>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../tango-deploy/" title="Deploying Tango" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Deploying Tango
              </span>
            </div>
          </a>
        
        
          <a href="../one-click/" title="(Legacy) OneClick Install" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                (Legacy) OneClick Install
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/Autolab" target="_blank" rel="noopener" title="" class="md-footer-social__link fa fa-"></a>
    
      <a href="https://facebook.com/autolabproject" target="_blank" rel="noopener" title="" class="md-footer-social__link fa fa-"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.c33a9706.js"></script>
      
      <script>app.initialize({version:"1.1",url:{base:".."}})</script>
      
    
  </body>
</html>